---
import Layout from "@/layouts/Layout.astro";
const base = import.meta.env.BASE_URL || "/";
const thanksPath = `${base}contact/thanks`;
// 送信先: Google Apps Script Web アプリ（.env の PUBLIC_CONTACT_FORM_ACTION で上書き可能）
const formAction =
	typeof import.meta.env.PUBLIC_CONTACT_FORM_ACTION === "string" && import.meta.env.PUBLIC_CONTACT_FORM_ACTION
		? import.meta.env.PUBLIC_CONTACT_FORM_ACTION
		: "https://script.google.com/macros/s/AKfycbzeZ9HisrevaaWKgRKIDci3ac30CW-BZqx_0Jb_aQD44sGwfMnbsBfVkxO0TBPgTjq8/exec";
---

<Layout title="お問い合わせ | DevClaw" description="DevClaw へのお問い合わせ。Mac Mini 環境構築・セキュリティDDについてご相談ください。">
	<div class="min-h-screen w-full max-w-[100vw] overflow-x-hidden bg-[#1A1E27]">
		<!-- ヘッダー: 戻る + サイト名 -->
		<header class="border-b border-white/10">
			<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-14 flex items-center justify-between">
				<a href={base} class="no-underline flex items-center gap-2 text-white/90 hover:text-white transition-colors">
					<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M19 12H5M12 19l-7-7 7-7" />
					</svg>
					<span class="font-semibold">DevClaw</span>
				</a>
			</div>
		</header>

		<main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12 lg:py-16 overflow-x-hidden">
			<div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-16 items-start min-w-0">
				<!-- 左カラム: お問い合わせ案内 -->
				<div class="lg:sticky lg:top-24">
					<div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-brand/90 text-white text-xs font-bold tracking-widest uppercase mb-6">
						お問い合わせ
					</div>
					<h1 class="text-3xl sm:text-4xl font-extrabold text-white tracking-tight mb-6">
						お問い合わせ
					</h1>
					<p class="text-slate-300 leading-relaxed mb-10">
						Mac Mini の環境構築やセキュリティDDについて、お気軽にご相談ください。現役セキュリティエンジニアがご対応します。
					</p>
					<div class="mb-10">
						<h2 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4">お問い合わせでわかること</h2>
						<ul class="space-y-4">
							<li class="flex gap-3 items-start">
								<span class="flex-shrink-0 w-6 h-6 rounded-full bg-brand/20 flex items-center justify-center mt-0.5">
									<svg class="w-3.5 h-3.5 text-brand" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
								</span>
								<span class="text-slate-300">環境構築・セキュリティ設定の内容と料金の目安</span>
							</li>
							<li class="flex gap-3 items-start">
								<span class="flex-shrink-0 w-6 h-6 rounded-full bg-brand/20 flex items-center justify-center mt-0.5">
									<svg class="w-3.5 h-3.5 text-brand" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
								</span>
								<span class="text-slate-300">セキュリティDD（デューデリジェンス）の流れ</span>
							</li>
							<li class="flex gap-3 items-start">
								<span class="flex-shrink-0 w-6 h-6 rounded-full bg-brand/20 flex items-center justify-center mt-0.5">
									<svg class="w-3.5 h-3.5 text-brand" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
								</span>
								<span class="text-slate-300">導入から納品・サポートまでのスケジュール感</span>
							</li>
							<li class="flex gap-3 items-start">
								<span class="flex-shrink-0 w-6 h-6 rounded-full bg-brand/20 flex items-center justify-center mt-0.5">
									<svg class="w-3.5 h-3.5 text-brand" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
								</span>
								<span class="text-slate-300">貴社の環境に合わせた無料見積り</span>
							</li>
						</ul>
					</div>
					<p class="text-sm text-slate-500">
						まずは、お気軽にご連絡ください。
					</p>
				</div>

				<!-- 右カラム: フォーム（スマホで右余白が消えないよう w-full max-w-full で幅を明示） -->
				<div class="w-full min-w-0 max-w-full overflow-x-hidden bg-white rounded-3xl border border-slate-200 shadow-xl relative">
					<!-- 左右同じ余白を明示（右側が欠けて見えない不具合を防止） -->
					<div class="w-full max-w-full box-border px-5 py-6 sm:px-8 sm:py-8 lg:px-10 lg:py-10 relative">
					<!-- GAS のレスポンスを隠すため iframe に送信し、完了は自サイトへリダイレクト -->
					<iframe
						name="contact-form-iframe"
						title="送信先"
						class="absolute w-0 h-0 border-0 opacity-0 pointer-events-none"
						aria-hidden="true"
					></iframe>
					<form
						action={formAction}
						method="POST"
						class="space-y-6 w-full min-w-0 max-w-full box-border"
						id="contact-form"
						aria-label="お問い合わせフォーム"
						target="contact-form-iframe"
					>
						<div>
							<label for="company" class="block text-sm font-semibold text-slate-700 mb-1.5">会社名・組織名 <span class="text-red-500">*</span></label>
							<input
								type="text"
								id="company"
								name="company"
								required
								placeholder="例: 株式会社サンプル"
								class="w-full min-w-0 max-w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-colors box-border"
							/>
						</div>
						<div>
							<label for="name" class="block text-sm font-semibold text-slate-700 mb-1.5">お名前 <span class="text-red-500">*</span></label>
							<input
								type="text"
								id="name"
								name="name"
								required
								placeholder="例: 山田 太郎"
								class="w-full min-w-0 max-w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-colors box-border"
							/>
						</div>
						<div>
							<label for="email" class="block text-sm font-semibold text-slate-700 mb-1.5">メールアドレス <span class="text-red-500">*</span></label>
							<input
								type="email"
								id="email"
								name="email"
								required
								placeholder="例: taro@example.com"
								class="w-full min-w-0 max-w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-colors box-border"
							/>
						</div>
						<div>
							<label for="phone" class="block text-sm font-semibold text-slate-700 mb-1.5">電話番号 <span class="text-slate-400 font-normal">(任意)</span></label>
							<input
								type="tel"
								id="phone"
								name="phone"
								placeholder="例: 03-1234-5678"
								class="w-full min-w-0 max-w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-colors box-border"
							/>
						</div>
						<div>
							<label for="message" class="block text-sm font-semibold text-slate-700 mb-1.5">お問い合わせ内容 <span class="text-slate-400 font-normal">(任意)</span></label>
							<textarea
								id="message"
								name="message"
								rows={5}
								placeholder="ご要件やご質問など、お気軽にご記入ください。"
								class="w-full min-w-0 max-w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-colors resize-y min-h-[120px] box-border"
							></textarea>
						</div>
						<div class="flex items-start gap-3">
							<input
								type="checkbox"
								id="privacy"
								name="privacy"
								required
								class="mt-1 w-4 h-4 rounded border-slate-300 text-brand focus:ring-brand/50"
							/>
							<label for="privacy" class="text-sm text-slate-600 leading-relaxed">
								<a href={`${base}privacy`} class="text-brand hover:underline" target="_blank" rel="noopener noreferrer">プライバシーポリシー</a>に同意する。
							</label>
						</div>
						<div class="pt-2">
							<button
								type="submit"
								id="contact-submit"
								class="w-full min-w-0 max-w-full py-4 px-6 text-base font-semibold text-white bg-brand hover:bg-brand-dark rounded-xl transition-all duration-200 shadow-lg shadow-brand/25 hover:shadow-brand/40 hover:-translate-y-0.5 flex items-center justify-center gap-2 disabled:opacity-70 disabled:pointer-events-none box-border"
							>
								<span id="contact-submit-text">お問い合わせする</span>
								<svg id="contact-submit-icon" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
							</button>
						</div>
					</form>
					</div>
				</div>
			</div>
		</main>
	</div>

	<script define:vars={{ thanksPath }}>
		const form = document.getElementById("contact-form");
		const submitBtn = document.getElementById("contact-submit");
		const submitText = document.getElementById("contact-submit-text");
		const submitIcon = document.getElementById("contact-submit-icon");
		if (form && submitBtn && thanksPath) {
			form.addEventListener("submit", function () {
				submitBtn.disabled = true;
				submitText.textContent = "送信中...";
				submitIcon.classList.add("animate-pulse");
				setTimeout(function () {
					window.location.href = thanksPath;
				}, 2000);
			});
		}
	</script>
</Layout>
